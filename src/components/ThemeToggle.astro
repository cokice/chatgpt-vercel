<button
  id="themeToggle"
  class="flex items-center justify-center w-10 h-10 rounded-md border transition-colors hover:bg-slate/10"
  onclick="handleToggleTheme()"
>
  
</button>

<style>
  .sun {
    fill: black;
  }
  .moon {
    fill: transparent;
  }
  :global(html.dark) .sun {
    fill: transparent;
  }
  :global(html.dark) .moon {
    fill: grey;
  }
</style>

<script is:inline>
  const persistentTheme = localStorage.getItem("theme")
  const darkSchema = window.matchMedia("(prefers-color-scheme: dark)")
  function toggle(flag) {
    document.documentElement.classList.toggle("dark", flag)
    document
      .querySelector('meta[name="theme-color"]')
      .setAttribute("content", flag ? "#16161a" : "#f6f8fa")
  }

  function listener() {
    toggle(darkSchema?.matches)
  }

  if (persistentTheme) {
    toggle(persistentTheme === "dark")
  } else {
    darkSchema.addEventListener("change", listener)
    toggle(darkSchema?.matches)
  }

  function handleToggleTheme() {
    const element = document.documentElement
    element.classList.toggle("dark")

    const isDark = element.classList.contains("dark")
    document
      .querySelector('meta[name="theme-color"]')
      .setAttribute("content", isDark ? "#16161a" : "#f6f8fa")
    darkSchema.removeEventListener("change", listener)
    localStorage.setItem("theme", isDark ? "dark" : "light")
  }
</script>
